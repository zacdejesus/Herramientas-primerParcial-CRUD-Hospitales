@using Microsoft.AspNetCore.Identity
@using Microsoft.AspNetCore.Http
@inject RoleManager<IdentityRole> RoleManager
@inject IHttpContextAccessor HttpContextAccessor

@{
    ViewData["Title"] = "Create";
    var request = HttpContextAccessor.HttpContext.Request;
    var isPost = string.Equals(request.Method, "POST", StringComparison.OrdinalIgnoreCase);

}

<h1>Create Role</h1>

<form method="post">
    <div class="form-group">
        <label for="roleName">Role Name</label>
        <input type="text" class="form-control" id="roleName" name="roleName" placeholder="Enter role name" required>
    </div>
    <button type="submit" class="btn btn-primary">Create</button>
</form>

@{
    if (isPost)
    {
        var roleName = request.Form["roleName"];
        if (!string.IsNullOrEmpty(roleName))
        {
            var roleExists = RoleManager.RoleExistsAsync(roleName).Result;
            if (!roleExists)
            {
                var role = new IdentityRole(roleName);
                var result = RoleManager.CreateAsync(role).Result;
                if (result.Succeeded)
                {
                    <p>Role created successfully.</p>
                }
                else
                {
                    <p>Error creating role:</p>
                    <ul>
                        @foreach (var error in result.Errors)
                        {
                            <li>@error.Description</li>
                        }
                    </ul>
                }
            }
            else
            {
                <p>Role already exists.</p>
            }
        }
    }
}
